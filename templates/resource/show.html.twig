{% extends 'base.html.twig' %}

{% block title %}{{ resource.title }}{% endblock %}

{% block body %}
<main class="main-area">
    <div class="course-view-header">
        <div class="header-breadcrumb">
            <a href="{{ path('app_resource_index') }}" class="breadcrumb-link">
                <i class="fas fa-arrow-left"></i> Retour aux ressources
            </a>
        </div>
        
        <div class="header-title-section">
            <div class="course-title-wrapper">
                <div class="course-view-icon">
                    <i class="fas fa-file-alt"></i>
                </div>
                
                <div class="course-title-info">
                    <h1>{{ resource.title }}</h1>
                </div>
            </div>
            
            <div class="course-actions-group">
                <a href="{{ path('app_resource_edit', {'id': resource.id}) }}" class="btn-action-primary">
                    <i class="fas fa-edit"></i> Modifier
                </a>
                <button type="button" class="btn-action-danger" onclick="document.getElementById('deleteForm').style.display='flex'">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </div>
        </div>
    </div>

    <div class="course-view-grid">
        <div class="course-main-content">
            <div class="info-card">
                <div class="info-card-header">
                    <h2><i class="fas fa-info-circle"></i> Informations de la ressource</h2>
                </div>
                <div class="info-card-body">
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Module associé</span>
                            <div class="course-badge-info">
                                <i class="fas fa-layer-group"></i>
                                <span>{{ resource.module ? resource.module.title : 'Non assigné' }}</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Type de ressource</span>
                            <div class="type-badge">
                                {% if resource.type == 'file' %}
                                    <i class="fas fa-file-pdf"></i>
                                    <span>Fichier</span>
                                {% elseif resource.type == 'link' %}
                                    <i class="fas fa-link"></i>
                                    <span>Lien externe</span>
                                {% else %}
                                    <i class="fas fa-align-left"></i>
                                    <span>Texte riche</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-card">
                <div class="info-card-header">
                    <h2><i class="fas fa-file-alt"></i> Contenu de la ressource</h2>
                </div>
                <div class="info-card-body">
                    {% if resource.type == 'file' %}
                        <div class="resource-file-preview">
                            <div class="file-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="file-info">
                                <h4>Document disponible</h4>
                                <p>Cliquez sur le bouton ci-dessous pour télécharger ou visualiser le document</p>
                                <a href="{{ asset('uploads/resources/' ~ resource.content) }}" target="_blank" class="btn-download">
                                    <i class="fas fa-download"></i> Télécharger le document
                                </a>
                            </div>
                        </div>
                    {% elseif resource.type == 'link' %}
                        <div class="resource-link-preview">
                            <div class="link-icon">
                                <i class="fas fa-external-link-alt"></i>
                            </div>
                            <div class="link-info">
                                <h4>Lien externe</h4>
                                <p class="link-url">{{ resource.content }}</p>
                                <a href="{{ resource.content }}" target="_blank" class="btn-visit-link">
                                    <i class="fas fa-arrow-right"></i> Visiter le lien
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="resource-text-content">
                            {{ resource.content|nl2br }}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="course-sidebar-info">
            <div class="stats-card">
                <h3>Informations</h3>
                <div class="stat-item-large">
                    <div class="stat-icon purple">
                        {% if resource.type == 'file' %}
                            <i class="fas fa-file-pdf"></i>
                        {% elseif resource.type == 'link' %}
                            <i class="fas fa-link"></i>
                        {% else %}
                            <i class="fas fa-align-left"></i>
                        {% endif %}
                    </div>
                    <div class="stat-details">
                        <span class="stat-value">
                            {% if resource.type == 'file' %}
                                Fichier
                            {% elseif resource.type == 'link' %}
                                Lien
                            {% else %}
                                Texte
                            {% endif %}
                        </span>
                        <span class="stat-label">Type</span>
                    </div>
                </div>
            </div>

            <div class="quick-actions-card">
                <h3>Actions rapides</h3>
                <a href="{{ path('app_resource_edit', {'id': resource.id}) }}" class="quick-action-btn">
                    <i class="fas fa-edit"></i>
                    <span>Modifier cette ressource</span>
                </a>
                <a href="{{ path('app_resource_index') }}" class="quick-action-btn">
                    <i class="fas fa-list"></i>
                    <span>Voir toutes les ressources</span>
                </a>
                {% if resource.module %}
                <a href="{{ path('app_module_show', {'id': resource.module.id}) }}" class="quick-action-btn">
                    <i class="fas fa-layer-group"></i>
                    <span>Voir le module</span>
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div id="deleteForm" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;" onclick="if(event.target === this) this.style.display='none'">
        <div style="background: white; padding: 40px; border-radius: 20px; max-width: 500px; text-align: center;">
            <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #dc2626; margin-bottom: 20px;"></i>
            <h2 style="margin-bottom: 15px; color: #1e293b;">Confirmer la suppression</h2>
            <p style="color: #64748b; margin-bottom: 30px;">Êtes-vous sûr de vouloir supprimer cette ressource ? Cette action est irréversible.</p>
            {{ include('resource/_delete_form.html.twig') }}
            <button onclick="document.getElementById('deleteForm').style.display='none'" style="margin-left: 10px; padding: 12px 24px; background: white; border: 1px solid #e2e8f0; border-radius: 30px; font-weight: 600; cursor: pointer;">Annuler</button>
        </div>
    </div>
</main>
{% endblock %}
